# ESS_18022025 Class 4

The `millis()` function in Arduino returns the number of milliseconds that have passed since the Arduino board began running the current program. This function is useful for timing events and creating non-blocking delays in your code. Here's an example of how you might use it:

### Example 1 - Count every 1000ms (Flash LED)

```cpp
unsigned long previousMillis = 0;
const long interval = 1000; // interval at which to blink (milliseconds)

void setup() {
  pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;
    digitalWrite(LED_BUILTIN, !digitalRead(LED_BUILTIN));
  }
}
```

In this example, the LED will toggle its state every second.

### Example 2 - Count every second (serial output)

```cpp
unsigned long previousMillis = 0;
const long interval = 1000; // interval at which to blink (milliseconds)
unsigned long secondsCount = 0;

void setup() {
  pinMode(LED_BUILTIN, OUTPUT);
  Serial.begin(9600); // Initialize serial communication at 9600 bps
}

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;
    digitalWrite(LED_BUILTIN, !digitalRead(LED_BUILTIN));
    
    // Increment the seconds counter
    secondsCount = (secondsCount + 1) % 60; // Reset to 0 after 59 seconds
    Serial.print("Seconds: ");
    Serial.println(secondsCount);
  }
}
```

### Example 3 - count till 100 then reset every 5 seconds
```cpp
unsigned long previousMillis = 0;
const long interval = 5000; // interval at which to reset the count (milliseconds)
int count = 0;

void setup() {
  Serial.begin(9600); // Initialize serial communication at 9600 bps
}

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;
    count = 0; // Reset count every 5 seconds
  }

  count = (currentMillis - previousMillis) / 50; // Increment count based on time passed
  Serial.print("Count: ");
  Serial.println(count);
}
```
### Example 4 - Alternate 2 leds every 500ms (first one led blink then, second led blink alternately)
```cpp
const int led1 = 13; // Pin for LED 1
const int led2 = 12; // Pin for LED 2

unsigned long previousMillis = 0;
const long interval = 500; // interval at which to alternate LEDs (milliseconds)

void setup() {
  pinMode(led1, OUTPUT);
  pinMode(led2, OUTPUT);
  digitalWrite(led1, HIGH); // Start with LED 1 on
  digitalWrite(led2, LOW);  // Start with LED 2 off
}

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;

    // Toggle the LEDs
    digitalWrite(led1, !digitalRead(led1));
    digitalWrite(led2, !digitalRead(led2));
  }
}
```

### Example 5 - Alternate the 2 leds every 500ms but use the PWM pins to fade in and fade out
```cpp
const int led1 = 9; // PWM pin for LED 1
const int led2 = 10; // PWM pin for LED 2

unsigned long previousMillis = 0;
const long interval = 1000; // interval at which to change LED brightness (milliseconds)
int brightness = 0; // initial brightness level
int fadeAmount = 5; // amount to change the brightness

void setup() {
  pinMode(led1, OUTPUT);
  pinMode(led2, OUTPUT);
}

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;

    // Gradually increase brightness
    brightness = brightness + fadeAmount;
    
    // Reverse the direction of fading at the ends of the fade
    if (brightness <= 0 || brightness >= 255) {
      fadeAmount = -fadeAmount;
    }

    // Set the brightness of the LEDs
    analogWrite(led1, brightness);
    analogWrite(led2, brightness);
  }
}
```
